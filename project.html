<!-- ì¤‘ê°„ ìƒëµ, ê¸°ì¡´ ì½”ë“œ ë™ì¼ -->

<style>
  /* ... ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ ... */
  .section-card .story{
    white-space:pre-line;
    font-size:1.1rem;
    line-height:1.8;
    color:#222
  }
  .section-card .story a{color:#2563eb;text-decoration:underline}
  .section-card .story strong{
    display:block;
    margin-top:12px;
    font-weight:800;
    color:#111;
  }
</style>

<script type="module">
  import { injectLayout } from './js/include.js';
  import { getProjectById } from './js/api.js';
  import { storage } from './js/firebase.js';
  import { ref, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js";

  injectLayout({ active:'project' });

  const $detail=document.getElementById('project-detail');
  const fmt=n=>Number(n||0).toLocaleString('ko-KR');

  // ë§í¬ ë³€í™˜
  function linkify(text){
    return (text||'').replace(/(https?:\/\/[^\s]+)/g,'<a href="$1" target="_blank">$1</a>');
  }

  // ìŠ¤í† ë¦¬ UX ê°•ì¡°
  function highlightDescription(text){
    let html=linkify(text||'');
    html=html.replace(/ğŸ¾([^ğŸ¯ğŸ“¸]+)/g,'<strong>ğŸ¾$1</strong>');
    html=html.replace(/ğŸ¯([^ğŸ“¸]+)/g,'<strong>ğŸ¯$1</strong>');
    html=html.replace(/ğŸ“¸(.+)/g,'<strong>ğŸ“¸$1</strong>');
    return html;
  }

  async function render(){
    const id=new URLSearchParams(location.search).get("id");
    if(!id){$detail.innerHTML='<div class="muted">ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤.</div>';return;}
    try{
      const p=await getProjectById(id);
      if(!p){$detail.innerHTML='<div class="muted">ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.</div>';return;}

      // ... ê¸°ì¡´ ì‚¬ì§„/ì§„í–‰ë¥  ì½”ë“œ ë™ì¼ ...

      $detail.innerHTML=`
        <!-- ì‚¬ì§„ ì¹´ë“œ ... ë™ì¼ -->

        <!-- ìŠ¤í† ë¦¬ -->
        <section class="section-card">
          <h2>ìŠ¤í† ë¦¬</h2>
          <div class="story">${highlightDescription(p.description)}</div>
        </section>

        <!-- ë²„íŠ¼ / Beta ì•ˆë‚´ ... ë™ì¼ -->
      `;

      // ... ê¸°ì¡´ shareCopy, carousel ë¡œì§ ë™ì¼ ...
    }catch(e){
      console.error(e);
      $detail.innerHTML='<div class="muted">í”„ë¡œì íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</div>';
    }
  }
  render();
</script>
