<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>프로젝트 상세 — Project.PAW</title>
  <link rel="stylesheet" href="common.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body>
  <header style="background:white; border-bottom:1px solid #e5e7eb">
    <div class="container-narrow" style="display:flex; align-items:center; justify-content:space-between; padding:14px 0">
      <a class="navbar-brand" href="index.html"><strong>Project.PAW</strong></a>
      <nav class="toolbar">
        <a class="btn secondary" href="project_list.html">후원하기</a>
        <a class="btn secondary" href="create.html">등록하기</a>
      </nav>
    </div>
  </header>

  <main class="container-narrow" style="padding:24px 0">
    <div id="content"></div>
  </main>

  <script src="paw.js"></script>
  <script>
    const root = document.querySelector('#content');
    const p = loadProjectFromUrl();
    if(!p){
      root.innerHTML = '<div class="empty">프로젝트를 찾을 수 없습니다.</div>';
    } else {
      const pct = calcProgress(p);
      const cover = (p.representativeImage && p.representativeImage.dataUrl) ? p.representativeImage.dataUrl : '';
      const gal = (p.gallery||[]).map(g=>`<img src="${g.dataUrl}" alt="">`).join('');
      const receipts = (p.receipts||[]).map(g=>`<img src="${g.dataUrl}" alt="">`).join('');
      root.innerHTML = `
        <article class="card">
          <img src="${cover}" alt="" onerror="this.style.display='none'"/>
          <div class="body">
            <div class="toolbar" style="justify-content:space-between">
              <span class="badge">진행중</span>
              <small class="muted">${new Date(p.createdAt).toLocaleString('ko-KR')}</small>
            </div>
            <h2 style="margin:4px 0 2px">${p.name}</h2>
            <small class="muted">by ${p.rescuerName}</small>
            <div class="progress-wrap" style="margin-top:8px"><div class="progress" style="width:${pct}%"></div></div>
            <small class="muted">목표 ${formatCurrency(p.goalAmount)} · 구조자 부담 ${formatCurrency(p.rescuerContribution)}</small>
            <p style="margin-top:12px">${(p.summary||'')}</p>
            <p>${(p.description||'').replaceAll('\n','<br/>')}</p>
            <div class="kicker" style="margin-top:10px">상황 사진</div>
            <div class="gallery">${gal || '<small class="muted">등록된 사진이 없습니다.</small>'}</div>
            <div class="kicker" style="margin-top:12px">영수증</div>
            <div class="gallery">${receipts || '<small class="muted">등록된 영수증이 없습니다.</small>'}</div>
            <hr class="sep"/>
            <div class="toolbar" style="gap:8px; flex-wrap:wrap">
              <a class="btn" href="${p.kakaoInviteLink}" target="_blank" rel="noopener">카카오톡 연결</a>
              <button class="btn secondary" onclick="copy(location.href)"><i class="bi bi-share"></i>&nbsp;공유</button>
            </div>
            <small class="muted" style="margin-top:8px; display:block">“책임의 끝과 공감의 시작이 만나는 곳.” — Project.PAW</small>
          </div>
        </article>
      `;
    }
  </script>
</body>
</html>
