<!-- Project.PAW — 안전 패치 (BETA 제거 · 가치문구 교체 · 계좌 팝업) -->
<style>
  /* 모달(독립 스타일) */
  .paw-modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:9999}
  .paw-modal[hidden]{display:none}
  .paw-dialog{position:relative;background:#fff;border-radius:16px;max-width:520px;width:92%;padding:24px 20px;box-shadow:0 10px 40px rgba(0,0,0,.2);
    font-family:'SUIT Variable','Pretendard',system-ui,sans-serif}
  .paw-dialog h3{margin:0 0 12px;font-size:20px;font-weight:800}
  .paw-acc{display:flex;gap:8px;align-items:center;justify-content:space-between;background:#f5f5f5;border-radius:12px;padding:12px}
  .paw-acc code{font-size:16px;font-weight:800;word-break:keep-all}
  .paw-copy{border:0;border-radius:10px;padding:8px 12px;cursor:pointer}
  .paw-close{border:0;background:transparent;font-size:28px;line-height:1;cursor:pointer;position:absolute;top:8px;right:12px}
  .paw-donor-msg{margin:12px 2px 0;font-size:14px;color:#333}
  .paw-hint{margin:4px 2px 0;font-size:12px;color:#666}
  .paw-toast{position:absolute;bottom:12px;left:50%;transform:translateX(-50%);background:#111;color:#fff;border-radius:999px;padding:6px 12px;font-size:12px}
</style>

<!-- 계좌번호 모달 -->
<div class="paw-modal" id="pawAccModal" hidden>
  <div class="paw-dialog" role="dialog" aria-modal="true" aria-labelledby="pawAccTitle">
    <button class="paw-close" aria-label="닫기">&times;</button>
    <h3 id="pawAccTitle">후원 계좌</h3>
    <div class="paw-acc">
      <code class="paw-acc-num">계좌번호 : KB국민 831801-04-173073 프로젝트파우</code>
      <button type="button" class="paw-copy">복사</button>
    </div>
    <p class="paw-donor-msg">보내주신 마음 100% 후원자에게 Direct로 전달됩니다</p>
    <p class="paw-hint">입금 후 단톡방에 간단히 인증해주시면 ‘연결된 마음 수’에 반영됩니다.</p>
    <div class="paw-toast" hidden>복사되었습니다</div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  /* ---------------------------
   * (1) BETA 블록 제거 (보수적 탐지)
   * --------------------------- */
  (function removeBeta() {
    // 먼저 흔한 id/class 시도
    const candidates = ['#betaBlock','#beta-block','#betaBanner','#beta-badge','.beta','.banner-beta','.paw-beta'];
    for (const sel of candidates) {
      const el = document.querySelector(sel);
      if (el) { el.remove(); return; }
    }
    // 텍스트 기반(‘BETA’, ‘실험 중’)인 가장 가까운 블록 제거
    const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_ELEMENT);
    while (walker.nextNode()) {
      const el = walker.currentNode;
      if (!el || !el.textContent) continue;
      const t = el.textContent.trim();
      if (/^\s*(BETA|베타)\s*$/i.test(t) || t.includes('아직은 실험 중') || t.includes('BETA')) {
        const block = el.closest('section,div,aside,header,footer') || el;
        block.remove();
        return;
      }
    }
  })();

  /* -------------------------------------
   * (2) “우리가 추구하는 가치” 문구 교체
   * ------------------------------------- */
  (function replaceValuesCopy() {
    const NEW_HTML = `
      <p>Project.PAW는 개인 구조자와 후원자가 직접 연결되는 작은 실험입니다.</p>
      <p>숫자보다 중요한 건 ‘연결된 마음’이고,<br/>그 마음이 행동으로 이어질 수 있도록 돕고 싶습니다.</p>
      <p><strong>2025.09월</strong>을 시작으로 작은 용기들이 모여 큰 변화가 될 거라 믿습니다. 🐾</p>
    `;
    // 제목 탐색(“우리가 추구하는 가치”)
    const headings = Array.from(document.querySelectorAll('h1,h2,h3,h4,h5'))
      .filter(h => /우리가\s*추구하는\s*가치/.test(h.textContent.trim()));
    if (headings.length) {
      const h = headings[0];
      const block = h.parentElement; // 보통 같은 컨테이너 안에 문단이 있음
      // 기존 문단 제거(헤딩은 유지)
      Array.from(block.querySelectorAll('p')).forEach(p => p.remove());
      const wrap = document.createElement('div');
      wrap.innerHTML = NEW_HTML;
      block.appendChild(wrap);
    }
  })();

  /* ---------------------------------------------------
   * (3) “후원하기 가기” → 계좌번호 팝업 + 복사 기능
   *     (기존 링크/로직은 막고 팝업만 띄움)
   * --------------------------------------------------- */
  const ACCOUNT_TEXT = '계좌번호 : KB국민 831801-04-173073 프로젝트파우';
  const DONOR_MSG = '보내주신 마음 100% 후원자에게 Direct로 전달됩니다';

  const modal = document.getElementById('pawAccModal');
  const accEl = modal.querySelector('.paw-acc-num');
  const copyBtn = modal.querySelector('.paw-copy');
  const toast = modal.querySelector('.paw-toast');
  const donorMsgEl = modal.querySelector('.paw-donor-msg');

  function openModal(e) {
    if (e) e.preventDefault();
    accEl.textContent = ACCOUNT_TEXT;
    donorMsgEl.textContent = DONOR_MSG;
    modal.hidden = false;
    document.body.style.overflow = 'hidden';
  }
  function closeModal() {
    modal.hidden = true;
    document.body.style.overflow = '';
  }

  // 닫기(배경/버튼)
  modal.addEventListener('click', (e) => {
    if (e.target.classList.contains('paw-modal') || e.target.classList.contains('paw-close')) {
      closeModal();
    }
  });

  // 복사
  copyBtn.addEventListener('click', async () => {
    try {
      await navigator.clipboard.writeText(ACCOUNT_TEXT);
      toast.hidden = false;
      setTimeout(() => (toast.hidden = true), 1400);
    } catch (_) {
      // 폴백
      const ta = document.createElement('textarea');
      ta.value = ACCOUNT_TEXT;
      document.body.appendChild(ta);
      ta.select();
      document.execCommand('copy');
      ta.remove();
      toast.hidden = false;
      setTimeout(() => (toast.hidden = true), 1400);
    }
  });

  // 대상 버튼: id/class가 불명확하므로 텍스트 매칭(안전)
  const donateTargets = Array.from(document.querySelectorAll('a,button,#donateBtn,#donate,.donate,.donate-btn'))
    .filter(el => /후원하기\s*가기|후원하기|기부하기/.test(el.textContent.replace(/\s/g,'')));

  donateTargets.forEach(btn => {
    btn.addEventListener('click', openModal, { passive: false });
  });
});
</script>
<!-- / Project.PAW 안전 패치 -->
