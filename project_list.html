<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>후원하기 — Project.PAW</title>
  <link rel="stylesheet" href="common.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body>
  <header style="background:white; border-bottom:1px solid #e5e7eb">
    <div class="container-narrow" style="display:flex; align-items:center; justify-content:space-between; padding:14px 0">
      <a class="navbar-brand" href="index.html"><strong>Project.PAW</strong></a>
      <nav class="toolbar">
        <a class="btn secondary" href="index.html">홈</a>
        <a class="btn" href="create.html">등록하기</a>
      </nav>
    </div>
  </header>

  <main class="container-narrow">
    <section style="padding:24px 0">
      <div class="toolbar" style="justify-content:space-between">
        <h2 class="section-title" style="margin:0">모든 프로젝트</h2>
        <div class="toolbar">
          <label for="filter-approve" class="kicker" style="margin-right:6px">승인만</label>
          <input type="checkbox" id="filter-approve"/>
          <select id="sort">
            <option value="latest">최신순</option>
            <option value="progress">달성률순</option>
            <option value="goal">목표금액 높은순</option>
          </select>
        </div>
      </div>
      <div id="list-cards" class="grid" style="margin-top:16px"></div>
    </section>
  </main>

  <footer class="container-narrow">
    <small>© Project.PAW</small>
  </footer>

  <script src="paw.js"></script>
  <script>
    const cards = document.querySelector('#list-cards');
    const sortSel = document.querySelector('#sort');
    const approveOnly = document.querySelector('#filter-approve');
    function render(){
      let items = getProjects();
      if(approveOnly.checked){ items = items.filter(p=>p.adminApproved===true); }
      const mode = sortSel.value;
      if(mode==='latest') items.sort((a,b)=>b.createdAt - a.createdAt);
      if(mode==='progress') items.sort((a,b)=>calcProgress(b)-calcProgress(a));
      if(mode==='goal') items.sort((a,b)=>Number(b.goalAmount||0)-Number(a.goalAmount||0));
      cards.innerHTML = (items.length? items.slice(0,6).map(renderCard).join("") : `<div class="empty">등록된 프로젝트가 없습니다.</div>`);
    }
    sortSel.addEventListener('change', render); approveOnly.addEventListener('change', render); render();
  </script>
</body>
</html>
